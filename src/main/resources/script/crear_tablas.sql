
 --https://www.youtube.com/watch?v=XYTTHY50Swo
 
 
INSERT INTO LISTA(NOMBRE,CODIGO)VALUES('Estado viajes'.'ESTADO_VIAJE');
INSERT INTO LISTA(NOMBRE,CODIGO)VALUES('Estado viajes'.'ESTADO_VIAJE');


INSERT INTO RUTA(NOMBRE,CODIGO)VALUES('La Marina / Javier Prado','RUTA1');
INSERT INTO RUTA(NOMBRE,CODIGO)VALUES('Centro de Lima / Chorrillos','RUTA2');
INSERT INTO RUTA(NOMBRE,CODIGO)VALUES('Begonia / La Molina','RUTA3');


INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA1'),'La Marina','Javier Prado');
INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA1'),'Javier Prado','La Marina');

INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA2'),'Centro de Lima','Chorrillos');
INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA2'),'Chorrillos','Centro de Lima');

INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA3'),'Begonia','La Molina');
INSERT INTO RUTA_DETALLE(RUTA,ORIGEN,DESTINO)VALUES((SELECT ID FROM RUTA WHERE CODIGO='RUTA3'),'La Molina','Begonia');

CREATE TABLE LISTA(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 NOMBRE VARCHAR(50),
 CODIGO VARCHAR(20)
);


ALTER TABLE LISTA
 add constraint pkLista
 primary key(ID); 

 
CREATE TABLE VALOR(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 LISTA INT NOT NULL,
 CODIGO VARCHAR(20),
 VALOR VARCHAR(100),
 AUX1 VARCHAR(100),
 AUX2 VARCHAR(100)
 
);

ALTER TABLE VALOR
 add constraint pkValor
 primary key(ID);
 
 

alter table VALOR
add constraint fkValorLista
foreign key (LISTA)
references LISTA (ID);



 CREATE TABLE RUTA(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 NOMBRE VARCHAR(50),
 CODIGO VARCHAR(20)
);


ALTER TABLE RUTA
 add constraint pkRuta
 primary key(ID);



 CREATE TABLE RUTA_DETALLE(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 RUTA INT NOT NULL,
 ORIGEN VARCHAR(100),
 DESTINO VARCHAR(100)
);


ALTER TABLE RUTA_DETALLE
 add constraint pkRutaDetalle
 primary key(ID);
 

alter table RUTA_DETALLE
add constraint fkRutaDetalleRuta
foreign key (RUTA)
references RUTA (ID);


--alter table RUTA_DETALLE
--add constraint fkRutaDetalleOrigenVal
--foreign key (ORIGEN)
--references VALOR (ID);



--alter table RUTA_DETALLE
--add constraint fkRutaDetalleDestinoVal
--foreign key (DESTINO)
--references VALOR (ID);




 
CREATE TABLE RUTA_HORARIO(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 RUTA_DETALLE INT NOT NULL,
 FECHA INT NOT NULL,
 HORA INT NOT NULL,
 MINUTO INT NOT NULL,
 ASIENTO INT NOT NULL
);


ALTER TABLE RUTA_HORARIO
 add constraint pkRutaHorario
 primary key(ID);

 
 alter table RUTA_HORARIO
add constraint fkRutaHorarioRutaDetalle
foreign key (RUTA_DETALLE)
references RUTA_DETALLE (ID);





 
CREATE TABLE RESERVA(
 ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY ,
 RUTA_DETALLE INT NOT NULL,
 FECHA timestamp  NOT NULL,
 HORA INT NOT NULL,
 MINUTO INT NOT NULL,
 ASIENTO INT NOT NULL,
 ESTADO INT NOT NULL
);


ALTER TABLE RESERVA
 add constraint pkReserva
 primary key(ID);

 
 alter table RESERVA
add constraint fkReservaRutaDetalle
foreign key (RUTA_DETALLE)
references RUTA_DETALLE (ID);


 alter table RESERVA
add constraint fkReservaEstado
foreign key (ESTADO)
references VALOR (ID);


 
----------------------------------------

CREATE TABLE USUARIO(
 ID int NOT NULL GENERATED BY DEFAULT AS IDENTITY,
 NOMBRE VARCHAR(100) NOT NULL,
 APELLIDO_PATERNO VARCHAR(50) NOT NULL,
 APELLIDO_MATERNO VARCHAR(50) NOT NULL,
 CLAVE VARCHAR(50) NOT NULL,
  CELULAR VARCHAR(20) NOT NULL,
  EMAIL VARCHAR(100) NOT NULL
);


ALTER TABLE USUARIO
 add constraint pkUsuario
 primary key(ID);
 
 
CREATE TABLE PERFIL(
 ID int NOT NULL GENERATED BY DEFAULT AS IDENTITY,
 NOMBRE VARCHAR(100) NOT NULL,
 CODIGO VARCHAR(20)
);



ALTER TABLE PERFIL
 add constraint pkPerfil
 primary key(ID);

 
 
CREATE TABLE USUARIO_PERFIL(
 ID int NOT NULL GENERATED BY DEFAULT AS IDENTITY,
 USUARIO int NOT NULL,
 PERFIL int NOT NULL
);



ALTER TABLE USUARIO_PERFIL
 add constraint pkUsuarioPerfil
 primary key(ID);
  
 

alter table USUARIO_PERFIL
add constraint fkUsuarioPerfilUsuario
foreign key (USUARIO)
references USUARIO (ID);


 
alter table USUARIO_PERFIL
add constraint fkUsuarioPerfilPerfil
foreign key (PERFIL)
references PERFIL (ID);


----------------------

---CREACION DE DATOS
INSERT INTO USUARIO(NOMBRE,APELLIDO_PATERNO,APELLIDO_MATERNO,CLAVE,CELULAR,EMAIL) VALUES('ADMINISTRADOR','AP','AM','ADMIN','123456789','ADMIN');
INSERT INTO PERFIL(NOMBRE,CODIGO)VALUES('Pasajero','PASAJERO');
INSERT INTO PERFIL(NOMBRE,CODIGO)VALUES('Conductor','CONDUCTOR');
INSERT INTO USUARIO_PERFIL(USUARIO,PERFIL)VALUES((SELECT ID FROM USUARIO WHERE EMAIL='ADMIN'),(SELECT ID FROM PERFIL WHERE NOMBRE='CONDUCTOR'));
INSERT INTO USUARIO_PERFIL(USUARIO,PERFIL)VALUES((SELECT ID FROM USUARIO WHERE EMAIL='ADMIN'),(SELECT ID FROM PERFIL WHERE NOMBRE='PASAJERO'));
